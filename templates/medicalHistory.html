{% extends 'index.html' %}
{% block content %}

<script>
    window.localStorage['MediSecEncKey'] = create_hash(window.localStorage['MediSecEncKey'] + '{{token}}');
</script>

<b style="color: red;">{{error_message}}</b>

<h1>This is the user home page.</h1>

{% if history %}
    {% for history_item in history %}
        <div style="border: 1px solid black">
            {% for name, value in history_item.items() %}
                <p>
                    <b>{{name}}:</b>
                    <script>
                        document.write(decrypt( "{{ value }}", localStorage.getItem('MediSecEncKey')));
                    </script>
                </p>
            {% endfor %}
        </div>
        </br>
    {% endfor %}
{% else %}
    <p>You don't have any medical history saved yet :(</p>
    <p>Click "Add Medical History" to get started!</p>
{% endif %}

{% endblock content %}